<!DOCTYPE html>
<html lang="en">
  <head>
    @@include('../layouts/head-page-meta.html', {'title': 'Progress Tracker - Well-being Dashboard'}) @@include('../layouts/head-css.html')
    <style>
      .progress-container {
        max-width: 800px;
        margin: auto;
        padding: 20px;
        background: #ffffff;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      }
      .progress-header {
        text-align: center;
        margin-bottom: 20px;
      }
      .progress-header h3 {
        font-size: 1.8em;
        color: #2b2b2b;
      }
      .progress-details p {
        font-size: 1.1em;
        color: #555;
      }
      .progress-bar {
        margin-top: 15px;
      }
    </style>
  </head>
  <body @@bodySetup>
    @@include('../layouts/layout-vertical.html')

    <div class="pc-container">
      <div class="pc-content">
        <div class="progress-container" id="progress-list">
          <!-- Dynamic Content from JavaScript will go here -->
        </div>
      </div>
    </div>

    @@include('../layouts/footer-block.html') @@include('../layouts/footer-js.html')

    <script>
      // Function to Retrieve and Display Selected Issue in Progress Tracker
      // Function to Retrieve and Display Selected Issue in Progress Tracker
      function displayProgress() {
        const selectedIssueId = localStorage.getItem('selectedIssueId');
        const progressTracker = JSON.parse(localStorage.getItem('progressTracker'));
        const issues = JSON.parse(localStorage.getItem('issues'));

        const selectedIssue = progressTracker.find((entry) => entry.issueId == selectedIssueId);
        const issueDetails = issues.find((issue) => issue.id == selectedIssueId);

        const progressList = document.getElementById('progress-list');

        if (selectedIssue && issueDetails) {
          progressList.innerHTML = `
        <div class="progress-header">
            <h3>${issueDetails.summary}</h3>
        </div>
        <div class="progress-details">
            <p><strong>Department:</strong> ${selectedIssue.department}</p>
            <p><strong>Status:</strong> ${selectedIssue.status}</p>
            <p><strong>Category:</strong> ${selectedIssue.category}</p>
            <p><strong>Details:</strong> ${issueDetails.content}</p>
            <p><strong>AI Advice:</strong> Placeholder for AI-generated advice.</p>
            <p><strong>Company Notes:</strong> ${
              selectedIssue.actionsTaken.length > 0 ? selectedIssue.actionsTaken.join('<br>') : 'No actions taken yet.'
            }</p>
            <div class="progress-bar">
                <strong>Progress:</strong>
                <progress value="${getProgressValue(selectedIssue.status)}" max="100"></progress>
            </div>
        </div>`;
        } else {
          progressList.innerHTML = '<p>No issue selected or details unavailable.</p>';
        }
      }

      // Initialize displayProgress to load selected issue data on page load
      document.addEventListener('DOMContentLoaded', () => {
        displayProgress();
      });

      // Utility Function to Map Status to Progress Value
      function getProgressValue(status) {
        switch (status) {
          case 'To Do':
            return 0;
          case 'In Progress':
            return 50;
          case 'Completed':
            return 100;
          default:
            return 0;
        }
      }
    </script>
  </body>
</html>
